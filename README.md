# Система генерации и обработки событий, создания и хранения инцидентов на их основе

## Перед началом работы

1. В проекте `IncidentFinder.EventProcessor` изменить в `appsettings.json` следующую строку подключения к БД:

   ```plaintext
   "ConnectionStrings": {
    "DefaultConnection": "Server=localhost;Port=5432;Database=IncidentFinder;User Id=postgres;Password=dunkindonuts;"
   }
   ```
   
2. C помощью Project Manager  написать инструкцию в `IncidentFinder.Data.Context`:

   ```plaintext
   update-database
   ```
   
3. В настройках запуска выбрать два проекта: `IncidentFinder.EventProcessor` и `IncidentFinder.EventGenerator`. Важно, чтобы сначала был запущен процессор, и только после него генератор.
  
4. Вы готовы к работе! :)

## Сервисы:

1. **Генератор событий**
   - Генерирует события в случайные интервалы (например, каждые 2 секунды).
   - Имеет REST API (Swagger) для ручного запуска генерации события.
   - Отправляет события в Процессор через HTTP запросы.

2. **Процессор событий**
   - Принимает события через REST API (Swagger).
   - Создает инциденты на основе двух шаблонов:
     - **Шаблон №1 (Простой):** Создает инцидент типа 1 при получении события с `Event.Type = 1`.
     - **Шаблон №2 (Составной):** Создает инцидент типа 2, если событие с `Event.Type = 2` следует за событием с `Event.Type = 1` в течение 20 секунд; иначе создает инцидент типа 1. Составной шаблон имеет приоритет над простым.
   - Сохраняет инциденты в базе данных.
   - Предоставляет метод для получения списка инцидентов с возможностью сортировки и пагинации. Включает список событий, на основе которых были созданы инциденты.

### Сущности:

- **Событие:**
  ```csharp
  Event
  {
    Id: Guid,
    Type: EventTypeEnum (1, 2, 3, 4),
    Time: DateTime
  }

- **Инцидент:**
  ```csharp
  Incident
  {
    Id: Guid,
    Type: IncidentTypeEnum (1, 2),
    Time: DateTime
  }

